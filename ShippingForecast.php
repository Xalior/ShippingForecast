<?php

class ShippingForecast {

    function postByWeightAndZone($weight = NULL, $countrycode = NULL) {
        $z1countries = array(100,213,294,306,286);
        $z2countries = array(22,33,34,40,41,51,88,90,91,92,103,106,108.109,114,115,117,118,118,119,130,131,136,138,142,148,149,154,155,156,158,164,172,173,182,191,201,207,211,218,219,225,231,232,235,244,245,249,253,255,280,282,287,289,309);
        if($countrycode==NULL) { // Copy code from session
            $countrycode = $_SESSION['ship_country_id'];
        }
        if((in_array($countrycode,$z1countries)) || ($countrycode=="")) { // UK
            $weightTop = array
            (100,   250,    500,    750,    1000,   1250,   "+250");       
            $priceTop = array
            (1.09,  1.38,   1.84,   2.38,   2.92,   4.24,   0.75);
        } //END OF ZONE 161
        elseif(in_array($countrycode,$z2countries)) { // Just to make things confuing, this is AIRMAIL EUROPE
            $weightTop = array
            (10,    20,     40,     60,     80,     100,    120,    140,
             160,   180,    200,    220,    240,    260,    280,    300,
             320,   340,    360,    380,    400,    420,    440,    460,
             480,   500,    520,    540,    560,    580,    600,    620,
             640,   660,    680,    700,    720,    740,    760,    780,
             800,   820,    840,    860,    880,    900,    920,    940,
             960,   980,   1000,   1020,   1040,   1060,   1080,   1100, 
            1120,  1140,   1160,   1180,   1200,   1220,   1240,   1260,
            1280,  1300,   1320,   1340,   1360,   1380,   1400,   1420,
            1440,  1460,   1480,   1500,   1520,   1540,   1560,   1580,
            1600,  1620,   1640,   1660,   1680,   1700,   1720,   1740,
            1760,  1780,   1800,   1820,   1840,   1860,   1880,   1900,
            1920,  1940,   1960,   1980,   2000,   "+20"
            );
            $priceTop = array
(1.69, 1.69, 1.69, 1.69, 1.69, 1.69, 1.81, 1.94, 2.07, 2.2, 2.33, 2.45, 2.57, 2.69, 2.8, 2.91, 2.98, 3.08, 3.18, 3.28, 3.38, 3.48, 3.58, 3.68, 3.78, 3.88, 3.98, 4.08, 4.18, 4.28, 4.38, 4.48, 4.58, 4.68, 4.78, 4.88, 4.98, 5.08, 5.18, 5.28, 5.38, 5.48, 5.58, 5.68, 5.78, 5.88, 5.98, 6.08, 6.18, 6.28, 6.38, 6.48, 6.58, 6.68, 6.78, 6.88, 6.98, 6.08, 7.18, 7.28, 7.38, 7.48, 7.58, 7.68, 7.78, 7.88, 7.98, 8.08, 8.18, 8.28, 8.38, 8.48, 8.58, 8.68, 8.78, 8.88, 8.98, 9.08, 9.18, 9.28, 9.38, 9.48, 9.58, 9.68, 9.78, 9.88, 9.98, 10.08, 10.18, 10.28, 10.38, 10.48, 10.58, 10.68, 10.78, 10.88, 10.98, 11.08, 11.18, 11.28, 11.38, 0.6 );
        } //END OF ZONE2 
        else {  // Just to make things confuing, this is EVERYONE ELSE 
                // SMALL PACKETS don't know the difference between ZONE1
                // and ZONE2, Royal Mail Stylee! :-D
            $weightTop = array
            (10,    20,     40,     60,     80,     100,    120,    140,
             160,   180,    200,    220,    240,    260,    280,    300,
             320,   340,    360,    380,    400,    420,    440,    460,
             480,   500,    520,    540,    560,    580,    600,    620,
             640,   660,    680,    700,    720,    740,    760,    780,
             800,   820,    840,    860,    880,    900,    920,    940,
             960,   980,   1000,   1020,   1040,   1060,   1080,   1100, 
            1120,  1140,   1160,   1180,   1200,   1220,   1240,   1260,
            1280,  1300,   1320,   1340,   1360,   1380,   1400,   1420,
            1440,  1460,   1480,   1500,   1520,   1540,   1560,   1580,
            1600,  1620,   1640,   1660,   1680,   1700,   1720,   1740,
            1761,  1780,   1800,   1820,   1840,   1860,   1880,   1900,
            1920,  1940,   1960,   1980,   2000,   "+20"
            );
            $priceTop = array
(2.28, 2.28, 2.28, 2.28, 2.28, 2.28, 2.5, 2.72, 2.94, 3.16, 3.39, 3.59, 3.8, 4, 4.21, 4.42, 4.62, 4.82, 5.02, 5.22, 5.42, 5.62, 5.82, 6.02, 6.22, 6.42, 6.62, 6.82, 7.02, 7.22, 7.42, 7.62, 7.82, 8.02, 8.22, 8.42, 8.62, 8.82, 9.02, 9.22, 9.42, 9.62, 9.82, 10.02, 10.23, 10.42, 10.62, 10.82, 11.02, 11.22, 11.42, 11.62, 11.82, 12.02, 12.22, 12.42, 12.62, 12.82, 13.02, 13.22, 13.42, 13.62, 13.82, 14.02, 14.22, 14.42, 14.62, 14.82, 15.02, 15.22, 15.42, 15.62, 15.82, 16.02, 16.22, 16.42, 16.62, 16.82, 17.02, 17.22, 17.42, 17.62, 17.91, 18.02, 18.22, 18.42, 18.62, 18.82, 19.02, 19.22, 19.42, 19.62, 19.82, 20.02, 20.22, 20.42, 20.62, 20.82, 21.02, 21.22, 21.42, 0.9 );
        }
        for($loop=0;$loop<count($weightTop);$loop++) {
            if($weightTop[$loop]{0}=='+') {
                $partWeight=(int)(substr($weightTop[$loop],1));
                $partPrice=$priceTop[$loop]; 
                if($loop>0){
                    $starterFee=$priceTop[$loop-1];
                    $starterWeight=$weightTop[$loop-1];  
                } else {
                    $starterFee=0;
                    $starterWeight=0;
                }
                return($partPrice*(ceil(($weight-$starterWeight)/$partWeight))+$starterFee);
            }
            if($weightTop[$loop]>$weight) {
                return($priceTop[$loop]);
            }
        }
        return($price);
    }
}

?>
